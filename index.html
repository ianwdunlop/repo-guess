<!DOCTYPE html>
<html lang="en">

<head>
    <title>What's your favourite language?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="./gh-repository.js"></script>"
</head>

<body>
    <div class="container">
        <h3>Hello, enter your github user name and I'll guess your favourite language.</h4>
        <div>
            <input id="username" type="text" placeholder="Github user name" />
            <button onclick="findUser()">Go</button>
        </div>
        <h3 id="favourite-language"></h3>
    </div>
</body>
<script type="text/javascript">
    // Use jQuery, AJAX & JSONP to get user repository details from github
    function findUser() {
        var ghrepo = new thetravellingbard.GithubRepo("https://api.github.com");
        var callback = function(success, status, response) {
            var favouriteLanguage = ghrepo.favouriteLanguage(response);
            if (favouriteLanguage.count != 0) {
                var languages = favouriteLanguage.languages.join();
                // TODO - would be nice to replace the final ',' with 'and'
                $("#favourite-language").html("Your favourite language is <mark>" + languages + "</mark>");
            } else {
                $("#favourite-language").html("Couldn't find one. Sorry.");
            }

        };
        var username = $("#username")[0].value;
        if (username != null) {
            ghrepo.fetchRepositories(username, callback);
        } else {
            // error handling
        }
    }
</script>

</html>
